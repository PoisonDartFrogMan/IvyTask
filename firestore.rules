rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // settings: ユーザー自身のドキュメントのみ読み書き可能
    match /settings/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }

    // tasks: 自分の userId を持つドキュメントのみ
    match /tasks/{taskId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }

    // labels: 自分の userId を持つドキュメントのみ
    match /labels/{labelId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }

    // memos: 自分の userId を持つドキュメントのみ
    match /memos/{memoId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }

    // memo_folders: 自分の userId を持つドキュメントのみ
    match /memo_folders/{folderId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }

    // vaults: 自分の userId を持つドキュメントのみ
    match /vaults/{vaultId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }

    // candidates: 自分の userId を持つドキュメントのみ
    match /candidates/{candidateId} {
      allow read, write: if request.auth != null && request.auth.uid == resource.data.userId;
      allow create: if request.auth != null && request.auth.uid == request.resource.data.userId;
    }
  }
}
